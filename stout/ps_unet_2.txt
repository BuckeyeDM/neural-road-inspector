reading configurations from config file: cfg/ps_unet_2.cfg
x_data_dir: /home/paperspace/Data/training/v1/mapbox_set2/mapbox-sat2@2x/
y_data_dir: /home/paperspace/Data/training/v1/mapbox_set2/mapbox-st2@2x/
('model configuration options:', [u'id', u'optimizer', u'learning_rate', u'max_epoch', u'batch_size', u'model_dir'])
model_dir: /home/paperspace/Models/
model: Unet
learning rate: 0.0001
max epoch: 64
batch size: 16
____________________________________________________________________________________________________
Layer (type)                     Output Shape          Param #     Connected to                     
====================================================================================================
input_1 (InputLayer)             (None, 512, 512, 3)   0                                            
____________________________________________________________________________________________________
conv2d_1 (Conv2D)                (None, 512, 512, 32)  896         input_1[0][0]                    
____________________________________________________________________________________________________
conv2d_2 (Conv2D)                (None, 512, 512, 32)  9248        conv2d_1[0][0]                   
____________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)   (None, 256, 256, 32)  0           conv2d_2[0][0]                   
____________________________________________________________________________________________________
conv2d_3 (Conv2D)                (None, 256, 256, 64)  18496       max_pooling2d_1[0][0]            
____________________________________________________________________________________________________
conv2d_4 (Conv2D)                (None, 256, 256, 64)  36928       conv2d_3[0][0]                   
____________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)   (None, 128, 128, 64)  0           conv2d_4[0][0]                   
____________________________________________________________________________________________________
conv2d_5 (Conv2D)                (None, 128, 128, 128) 73856       max_pooling2d_2[0][0]            
____________________________________________________________________________________________________
conv2d_6 (Conv2D)                (None, 128, 128, 128) 147584      conv2d_5[0][0]                   
____________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)   (None, 64, 64, 128)   0           conv2d_6[0][0]                   
____________________________________________________________________________________________________
conv2d_7 (Conv2D)                (None, 64, 64, 256)   295168      max_pooling2d_3[0][0]            
____________________________________________________________________________________________________
conv2d_8 (Conv2D)                (None, 64, 64, 256)   590080      conv2d_7[0][0]                   
____________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)   (None, 32, 32, 256)   0           conv2d_8[0][0]                   
____________________________________________________________________________________________________
conv2d_9 (Conv2D)                (None, 32, 32, 512)   1180160     max_pooling2d_4[0][0]            
____________________________________________________________________________________________________
conv2d_10 (Conv2D)               (None, 32, 32, 512)   2359808     conv2d_9[0][0]                   
____________________________________________________________________________________________________
up_sampling2d_1 (UpSampling2D)   (None, 64, 64, 512)   0           conv2d_10[0][0]                  
____________________________________________________________________________________________________
concatenate_1 (Concatenate)      (None, 64, 64, 768)   0           up_sampling2d_1[0][0]            
                                                                   conv2d_8[0][0]                   
____________________________________________________________________________________________________
conv2d_11 (Conv2D)               (None, 64, 64, 256)   1769728     concatenate_1[0][0]              
____________________________________________________________________________________________________
conv2d_12 (Conv2D)               (None, 64, 64, 256)   590080      conv2d_11[0][0]                  
____________________________________________________________________________________________________
up_sampling2d_2 (UpSampling2D)   (None, 128, 128, 256) 0           conv2d_12[0][0]                  
____________________________________________________________________________________________________
concatenate_2 (Concatenate)      (None, 128, 128, 384) 0           up_sampling2d_2[0][0]            
                                                                   conv2d_6[0][0]                   
____________________________________________________________________________________________________
conv2d_13 (Conv2D)               (None, 128, 128, 128) 442496      concatenate_2[0][0]              
____________________________________________________________________________________________________
conv2d_14 (Conv2D)               (None, 128, 128, 128) 147584      conv2d_13[0][0]                  
____________________________________________________________________________________________________
up_sampling2d_3 (UpSampling2D)   (None, 256, 256, 128) 0           conv2d_14[0][0]                  
____________________________________________________________________________________________________
concatenate_3 (Concatenate)      (None, 256, 256, 192) 0           up_sampling2d_3[0][0]            
                                                                   conv2d_4[0][0]                   
____________________________________________________________________________________________________
conv2d_15 (Conv2D)               (None, 256, 256, 64)  110656      concatenate_3[0][0]              
____________________________________________________________________________________________________
conv2d_16 (Conv2D)               (None, 256, 256, 64)  36928       conv2d_15[0][0]                  
____________________________________________________________________________________________________
up_sampling2d_4 (UpSampling2D)   (None, 512, 512, 64)  0           conv2d_16[0][0]                  
____________________________________________________________________________________________________
concatenate_4 (Concatenate)      (None, 512, 512, 96)  0           up_sampling2d_4[0][0]            
                                                                   conv2d_2[0][0]                   
____________________________________________________________________________________________________
conv2d_17 (Conv2D)               (None, 512, 512, 32)  27680       concatenate_4[0][0]              
____________________________________________________________________________________________________
conv2d_18 (Conv2D)               (None, 512, 512, 32)  9248        conv2d_17[0][0]                  
____________________________________________________________________________________________________
conv2d_19 (Conv2D)               (None, 512, 512, 1)   33          conv2d_18[0][0]                  
====================================================================================================
Total params: 7,846,657
Trainable params: 7,846,657
Non-trainable params: 0
____________________________________________________________________________________________________
None
Epoch 1/64
Epoch 00000: val_loss improved from inf to -0.56023, saving model to /home/paperspace/Models/Unet-20170913-163455.hdf5
817s - loss: -4.3556e-01 - acc: 0.8363 - dice_coef: 0.4356 - val_loss: -5.6023e-01 - val_acc: 0.9212 - val_dice_coef: 0.5602
Epoch 2/64
Epoch 00001: val_loss improved from -0.56023 to -0.63073, saving model to /home/paperspace/Models/Unet-20170913-163455.hdf5
786s - loss: -6.0423e-01 - acc: 0.9167 - dice_coef: 0.6042 - val_loss: -6.3073e-01 - val_acc: 0.9257 - val_dice_coef: 0.6307
Epoch 3/64
Epoch 00002: val_loss improved from -0.63073 to -0.65320, saving model to /home/paperspace/Models/Unet-20170913-163455.hdf5
784s - loss: -6.3866e-01 - acc: 0.9246 - dice_coef: 0.6387 - val_loss: -6.5320e-01 - val_acc: 0.9305 - val_dice_coef: 0.6532
Epoch 4/64
Epoch 00003: val_loss improved from -0.65320 to -0.66419, saving model to /home/paperspace/Models/Unet-20170913-163455.hdf5
783s - loss: -6.6016e-01 - acc: 0.9295 - dice_coef: 0.6602 - val_loss: -6.6419e-01 - val_acc: 0.9336 - val_dice_coef: 0.6642
Epoch 5/64
Epoch 00004: val_loss improved from -0.66419 to -0.67280, saving model to /home/paperspace/Models/Unet-20170913-163455.hdf5
783s - loss: -6.7436e-01 - acc: 0.9326 - dice_coef: 0.6744 - val_loss: -6.7280e-01 - val_acc: 0.9356 - val_dice_coef: 0.6728
Epoch 6/64
Epoch 00005: val_loss improved from -0.67280 to -0.68067, saving model to /home/paperspace/Models/Unet-20170913-163455.hdf5
782s - loss: -6.8598e-01 - acc: 0.9352 - dice_coef: 0.6860 - val_loss: -6.8067e-01 - val_acc: 0.9359 - val_dice_coef: 0.6807
Epoch 7/64
Epoch 00006: val_loss improved from -0.68067 to -0.68675, saving model to /home/paperspace/Models/Unet-20170913-163455.hdf5
782s - loss: -6.9399e-01 - acc: 0.9370 - dice_coef: 0.6940 - val_loss: -6.8675e-01 - val_acc: 0.9380 - val_dice_coef: 0.6867
Epoch 8/64
Epoch 00007: val_loss improved from -0.68675 to -0.68980, saving model to /home/paperspace/Models/Unet-20170913-163455.hdf5
782s - loss: -6.9965e-01 - acc: 0.9383 - dice_coef: 0.6997 - val_loss: -6.8980e-01 - val_acc: 0.9357 - val_dice_coef: 0.6898
Epoch 9/64
Epoch 00008: val_loss improved from -0.68980 to -0.69009, saving model to /home/paperspace/Models/Unet-20170913-163455.hdf5
793s - loss: -7.0526e-01 - acc: 0.9395 - dice_coef: 0.7053 - val_loss: -6.9009e-01 - val_acc: 0.9355 - val_dice_coef: 0.6901
Epoch 10/64
Epoch 00009: val_loss improved from -0.69009 to -0.69204, saving model to /home/paperspace/Models/Unet-20170913-163455.hdf5
786s - loss: -7.1028e-01 - acc: 0.9406 - dice_coef: 0.7103 - val_loss: -6.9204e-01 - val_acc: 0.9380 - val_dice_coef: 0.6920
Epoch 11/64
Epoch 00010: val_loss improved from -0.69204 to -0.69378, saving model to /home/paperspace/Models/Unet-20170913-163455.hdf5
784s - loss: -7.1761e-01 - acc: 0.9422 - dice_coef: 0.7176 - val_loss: -6.9378e-01 - val_acc: 0.9410 - val_dice_coef: 0.6938
Epoch 12/64
Epoch 00011: val_loss did not improve
780s - loss: -7.2281e-01 - acc: 0.9433 - dice_coef: 0.7228 - val_loss: -6.9357e-01 - val_acc: 0.9417 - val_dice_coef: 0.6936
Epoch 13/64
Epoch 00012: val_loss improved from -0.69378 to -0.69561, saving model to /home/paperspace/Models/Unet-20170913-163455.hdf5
780s - loss: -7.2754e-01 - acc: 0.9443 - dice_coef: 0.7275 - val_loss: -6.9561e-01 - val_acc: 0.9418 - val_dice_coef: 0.6956
Epoch 14/64
Epoch 00013: val_loss improved from -0.69561 to -0.69825, saving model to /home/paperspace/Models/Unet-20170913-163455.hdf5
781s - loss: -7.3286e-01 - acc: 0.9455 - dice_coef: 0.7329 - val_loss: -6.9825e-01 - val_acc: 0.9398 - val_dice_coef: 0.6983
Epoch 15/64
Epoch 00014: val_loss improved from -0.69825 to -0.69975, saving model to /home/paperspace/Models/Unet-20170913-163455.hdf5
780s - loss: -7.3833e-01 - acc: 0.9466 - dice_coef: 0.7383 - val_loss: -6.9975e-01 - val_acc: 0.9407 - val_dice_coef: 0.6997
Epoch 16/64
Epoch 00015: val_loss did not improve
780s - loss: -7.4276e-01 - acc: 0.9476 - dice_coef: 0.7428 - val_loss: -6.9766e-01 - val_acc: 0.9421 - val_dice_coef: 0.6977
Epoch 17/64
Epoch 00016: val_loss improved from -0.69975 to -0.70161, saving model to /home/paperspace/Models/Unet-20170913-163455.hdf5
780s - loss: -7.4522e-01 - acc: 0.9481 - dice_coef: 0.7452 - val_loss: -7.0161e-01 - val_acc: 0.9419 - val_dice_coef: 0.7016
Epoch 18/64
Epoch 00017: val_loss did not improve
780s - loss: -7.4834e-01 - acc: 0.9487 - dice_coef: 0.7483 - val_loss: -6.9928e-01 - val_acc: 0.9420 - val_dice_coef: 0.6993
Epoch 19/64
Epoch 00018: val_loss did not improve
780s - loss: -7.5192e-01 - acc: 0.9495 - dice_coef: 0.7519 - val_loss: -6.9658e-01 - val_acc: 0.9420 - val_dice_coef: 0.6966
model training complete. time spent: 4:08:33.187430
